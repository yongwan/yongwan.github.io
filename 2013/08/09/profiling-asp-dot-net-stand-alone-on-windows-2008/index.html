
<!DOCTYPE html>
<html lang="en">
  <head>
		<!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
<!-- Enable responsive viewport -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<meta name="author" content="YongWan Jo">

<title>Windows 2008 서버에서 ASP.NET Profiling</title>

<!-- jQuery UI -->
<link href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" rel="stylesheet">

<!-- Bootstrap core CSS -->
<link href="/assets/themes/twitter/bootstrap/css/bootstrap.min.css" rel="stylesheet">

<!-- Documentation extras -->
<link href="/assets/themes/twitter/css/docs.css" rel="stylesheet">
<link href="/assets/themes/twitter/css/pygments-manni.css" rel="stylesheet">

<link href="/assets/themes/twitter/css-social-buttons/css/zocial.stripped.css" rel="stylesheet" type="text/css" >

<!-- Favicons -->
<link rel="icon" href="/assets/themes/twitter/favicon.ico">
<!--
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/apple-touch-icon-144-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/apple-touch-icon-114-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/apple-touch-icon-72-precomposed.png">
<link rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-57-precomposed.png">
<link rel="shortcut icon" href="assets/ico/favicon.png">
-->

<!-- atom & rss feed -->
<link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
<link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">   
  </head>
  <body>
		<!-- Header : Docs master nav -->
    <header class="navbar navbar-inverse navbar-fixed-top bs-docs-nav" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="/" class="navbar-brand">/* LIFE RUNS ON CODE */</a>
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav navbar-right">
				
				
				


  
    
      
        
        
        <li><a href="/archive.html">Archive</a></li>
        
        
      
    
  
    
      
    
  
    
      
        
        
        
        <li class="dropdown">
        
          <a class="dropdown-link" href="/categories">Categories</a>
          <a class="dropdown-toggle"><b class="caret" ></b></a>
          
          <div id="cat_tree" class="dropdown-menu">
            <ul> 
            
              


 

<li>
	<a href="/categories/common-tech">common tech <span class="badge">7</span></a>
	
	<ul>
	


 

<li>
	<a href="/categories/xml">xml <span class="badge">1</span></a>
</li>

	</ul>
	
	<ul>
	


 

<li>
	<a href="/categories/jquery">jquery <span class="badge">3</span></a>
</li>

	</ul>
	
	<ul>
	


 

<li>
	<a href="/categories/svg">svg <span class="badge">1</span></a>
</li>

	</ul>
	
	<ul>
	


 

<li>
	<a href="/categories/javascript">javascript <span class="badge">1</span></a>
</li>

	</ul>
	
	<ul>
	


 

<li>
	<a href="/categories/git">git <span class="badge">1</span></a>
</li>

	</ul>
	
</li>

            
              


 

<li>
	<a href="/categories/dot-net">.net <span class="badge">11</span></a>
	
	<ul>
	


 

<li>
	<a href="/categories/asp-dot-net-mvc">asp.net mvc <span class="badge">5</span></a>
</li>

	</ul>
	
	<ul>
	


 

<li>
	<a href="/categories/csharp">csharp <span class="badge">5</span></a>
</li>

	</ul>
	
	<ul>
	


 

<li>
	<a href="/categories/asp-dot-net">asp.net <span class="badge">1</span></a>
</li>

	</ul>
	
</li>

            
              


 

<li>
	<a href="/categories/applications">applications <span class="badge">3</span></a>
	
	<ul>
	


 

<li>
	<a href="/categories/visual-studio">visual studio <span class="badge">2</span></a>
</li>

	</ul>
	
</li>

            
            <ul>
          </div>
        </li>
        
      
    
  
    
      
    
  
    
      
        
        
        <li><a href="/tags.html">Tags</a></li>
        
        
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  



      </ul>
    </nav>
  </div>
</header>


    <div class="container bs-docs-container">
		
<div class="page-header">
  <h1>Windows 2008 서버에서 ASP.NET Profiling </h1>
</div>

<div class="date">
	<span>09 August 2013</span>
</div>
<div class="content">
	<p>요즘은 Performance Test 때문에 몇몇 팀원이 바쁘다.
나는 다행히(?)도 그쪽 일을 하고 있지 않아 한가한데 여차저차해서 Visual Studio Profiling 기능이 팀의 이슈가 되었다.
사실 예전에 한번 훑어 봤던 내용이기는 한데 한 번도 해보지를 않아서 이번 기회에 한 번 경험해봤다.</p>

<p><a href="http://msdn.microsoft.com/en-us/library/z9z62c29(v=vs.100).aspx">Visual Studio에서의 프로파일링</a>은 권차장님께서 이미 성공하셨다.
하지만 나는 호스트에는 VS와 DB가 Application + Web은 VM에 설치되어 있기 때문에 다른 방법이 필요했다.
해서 내 환경에 맞게 Remote Machine에 대한 Profiling을 찾아보던 중에 <a href="http://msdn.microsoft.com/en-us/library/dd255411(v=vs.100).aspx">Stand-Alone으로 Profiling</a>을 하는 방벙을 MSDN에서 찾게 되었다.
그리고 그와 연결되어 있던 <a href="http://msdn.microsoft.com/en-us/library/dd255401(v=vs.100).aspx">Command-Line Profiling of ASP.NET Web Applications</a>.</p>

<ul>
  <li>
    <p>Configuration</p>

    <ul>
      <li>우리는 아직 Visual Studio 2010을 사용하고 있기 때문에 <a href="http://www.microsoft.com/ko-kr/download/details.aspx?id=23205">Visual Studio 2010 성능 도구 서비스 팩 1</a>을 다운받고 설치.</li>
      <li>환경변수에 명령어 PATH설정<br />
  <code>set PATH=%PATH%;"C:\Program Files (x86)\Microsoft Visual Studio 9.0\Team Tools\Performance Tools"</code></li>
      <li>심볼 서버 설정을 위해 _NT_SYBBOL_PATH를 환경 변수에 등록<br />
  <code>set _NT_SYBBOL_PATH=symsrv*symsrv.dll*c:\localcache*http://msdl.microsoft.com/download/symbols</code><br />
  <em>c:\localcache</em>에 Compile시 생성된 PDB파일들을 Copy해야한다. <a href="http://msdn.microsoft.com/en-us/library/89axdy6y(v=vs.100).aspx">How to: Reference Windows Symbol Information</a></li>
    </ul>
  </li>
  <li>
    <p>실행</p>

    <ul>
      <li><code>VSPerfASPNETCmd websiteUrl</code></li>
    </ul>
  </li>
  <li>
    <p>Error</p>

    <p>과감하게 실행하고는 아래와 같은 Error가 나타났다. 쳇.
&gt; 오류
&gt;
&gt;	VSP 7008: ASP.net 예외: “웹 사이트 메타베이스에 예기치 않은 정보가 들어 있거나 메타베이스에 액세스할 수 있는 권한이 없습
  니다. IIS 메타베이스에 액세스하려면 로컬 컴퓨터의 Administrators 그룹 멤버여야 합니다. 따라서 로컬 IIS 웹 사이트를 만들
  거나 열 수 없습니다. 파일이 있는 폴더에 대해 읽기, 쓰기 및 수정 권한이 있으면 해당 폴더를 가리키는 파일 시스템 웹 사이트
  를 만들어 계속할 수 있습니다.”</p>
  </li>
  <li>
    <p>해결방법</p>

    <p><a href="http://blogs.msdn.com/b/profiler/archive/2010/07/23/tip-fixing-vsperfaspnetcmd-metabase-errors.aspx">Tip: Fixing VSPerfASPNetCmd metabase errors</a>에 의하면 IIS의 Feature를 Turn On하면 된다고 하는데 Windows 2008은 Feature가 서버 관리자에 있다.</p>

    <ul>
      <li>IIS 6 Scripting Tools</li>
      <li>IIS 6 WMI Compatibility</li>
      <li>IIS Metabase and IIS 6 configuration compatibility</li>
      <li>ASP.NET</li>
      <li>Windows Authentication</li>
    </ul>

    <p><img src="/assets/attachments/2013-08-09-profiling-error/WindowsFeatureOn2008_001.png" alt="서버 관리자" />
  <img src="/assets/attachments/2013-08-09-profiling-error/WindowsFeatureOn2008_002.png" alt="역할 서비스 추가" /></p>
  </li>
  <li>
    <p>결과</p>

    <ul>
      <li>결과로 떨어지는 .vsp는 Visual Studio에서 보면 야무치게 잘 나온다.</li>
      <li>Visual Studio로 Profiling을 했을 때는 Source까지 연결 되어 있던데 그 것까진 안된다.</li>
      <li>결과로 떨어지는 csv의 한글은 Excel에서 깨져서 보인다. 응급처치(?)는 <a href="http://blog.daum.net/sualchi/13720149">여기</a></li>
      <li>괜찮은 한국어 포스팅은 <a href="http://plantrue.tistory.com/24">여기</a></li>
      <li>Profiling중에 다른 Command를 사용해서 확인하고 싶은게 있다면 /NoWait Option을 사용하면 된다.</li>
    </ul>
  </li>
</ul>


</div>


<ul class="list-inline">
	<li><i class="glyphicon glyphicon-folder-open"></i></li>
	
	


  
     
    	<li><a href="/categories/dot-net">
    		.net <span>11</span>
    	</a></li>
     
    	<li><a href="/categories/asp-dot-net">
    		asp.net <span>1</span>
    	</a></li>
    
  


</ul>


<ul class="list-inline">
	<li><i class="glyphicon glyphicon-tags"></i></li>
	
	


  
     
    	<li><a href="/tags.html#profiling-ref" data-weight=1>profiling <span>1</span></a></li>
     
    	<li><a href="/tags.html#asp-dot-net-ref" data-weight=1>asp.net <span>1</span></a></li>
     
    	<li><a href="/tags.html#asp-dot-net-mvc-ref" data-weight=6>asp.net mvc <span>6</span></a></li>
     
    	<li><a href="/tags.html#visual-studio-ref" data-weight=2>visual studio <span>2</span></a></li>
     
    	<li><a href="/tags.html#windows-2008-ref" data-weight=1>windows 2008 <span>1</span></a></li>
     
    	<li><a href="/tags.html#vsp-7008-ref" data-weight=1>vsp 7008 <span>1</span></a></li>
    
  



</ul>

<ul class="pagination">

	<li class="prev"><a href="/2013/05/29/error-handling-on-jquery-ajax-on-asp-dot-net-mvc" title="ASP.NET MVC + jQuery AJAX 에서의 Error Handling">&larr; Previous</a></li>

	<li><a href="/archive.html">Archive</a></li>

	<li class="next disabled"><a>Next &rarr;</a>

</ul>




  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'yongwanjo'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>






    </div>
		
		<!-- Footer -->
    <footer class="bs-footer" role="contentinfo">
      <div class="container">
				<ul class="list-inline">
	
	<li>
		<a href="https://github.com/yongwan" class="zocial github icon" target="_blank">
		</a>
	</li>
	
	    
	
	<li>
		<a href="https://twitter.com/yongwany" class="zocial twitter icon" target="_blank">
		</a>
	</li>
	                          
	
	<li>
		<a href="http://www.facebook.com/yongwan.jo" class="zocial facebook icon" target="_blank">
		</a>
	</li>
	           
	                    
	
	
	<li>
		<a href="/atom.xml" class="zocial rss icon">
		</a>
	</li>
	
</ul>


&copy; 2013 YongWan Jo All rights reserved.
      </div>
    </footer>
	
		<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
<script src="/assets/themes/twitter/bootstrap/js/bootstrap.min.js"></script>

<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
  <script src="assets/js/html5shiv.js"></script>
  <script src="assets/js/respond.min.js"></script>
<![endif]-->

<script src="/assets/themes/twitter/js/jstree/jquery.jstree.js"></script>
<script>
$(function() {
  $("#cat_tree").jstree({
    "core" : {
      "animation" : 200
    },
    "plugins" : ["themes", "html_data"],
    "themes" : {
      "theme" : "wany",
      "icons" : false,
    },
  });
  
  $(".dropdown-toggle").on("click", function(event) {
    event.preventDefault();
    $("#cat_tree").slideToggle(200);
  });
});
</script>


		
    
  </body>
</html>

